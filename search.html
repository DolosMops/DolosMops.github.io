---
layout: default
title: Search
---

<h1>Cerca nel blog</h1>

<input id="searchBox" type="text" placeholder="Cerca qualcosa..." style="width:100%;padding:10px;margin:20px 0;font-size:1rem;">

<ul id="results"></ul>

<script src="https://unpkg.com/lunr/lunr.js"></script>
<script>
  async function loadIndex() {
    const res = await fetch('/search.json');
    return await res.json();
  }

  async function runSearch() {
    const data = await loadIndex();

    const idx = lunr(function () {
      this.ref('url');
      this.field('title');
      this.field('content');

      data.forEach(d => this.add(d));
    });

    const query = document.getElementById('searchBox').value;
    const results = idx.search(query);

    const list = document.getElementById('results');
    list.innerHTML = "";

    results.forEach(r => {
      const item = data.find(d => d.url === r.ref);
      list.innerHTML += `<li><a href="${item.url}">${item.title}</a></li>`;
    });
  }

  document.getElementById('searchBox').addEventListener('input', runSearch);
</script>
